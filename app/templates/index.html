{% extends "base.html" %}
{% block title %}Prem AI Clone{% endblock %}

{% block content %}
<style>
    .mic-visual{
    position: relative;
    width: 120px;
    height: 120px;
    margin: auto;
}

.mic-core{
    width: 60px;
    height: 60px;
    background: linear-gradient(135deg,#6366f1,#9333ea);
    border-radius: 50%;
    position: absolute;
    top: 30px;
    left: 30px;
    box-shadow: 0 0 30px rgba(99,102,241,.5);
}

.mic-wave{
    position: absolute;
    border: 2px solid rgba(99,102,241,.4);
    border-radius: 50%;
    animation: micWave 2s infinite ease-out;
}

.wave1{
    width: 80px;
    height: 80px;
    top: 20px;
    left: 20px;
}

.wave2{
    width: 100px;
    height: 100px;
    top: 10px;
    left: 10px;
    animation-delay: .5s;
}

.wave3{
    width: 120px;
    height: 120px;
    top: 0;
    left: 0;
    animation-delay: 1s;
}

@keyframes micWave{
    0%{
        transform: scale(.8);
        opacity: .8;
    }
    100%{
        transform: scale(1.3);
        opacity: 0;
    }
}

</style>

<div class="h-screen flex bg-[#f9fafb] font-sans overflow-hidden">

    <!-- SIDEBAR -->
    <aside class="w-80 bg-white border-r border-gray-100 flex flex-col">

        <div class="p-8">
            <h1 class="text-xl font-bold mb-6 flex items-center gap-2">
                <span class="w-2 h-8 bg-blue-600 rounded-full"></span>
                Chat History
            </h1>

            <button onclick="createNewChat()"
                class="w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-xl shadow-lg shadow-blue-500/20 transition">
                + New Chat
            </button>
        </div>

        <div id="chat-list"
             class="flex-1 overflow-y-auto px-4 pb-4 space-y-2">
        </div>

    </aside>

    <!-- MAIN CHAT -->
    <main class="flex-1 flex flex-col bg-white">

        <!-- HEADER -->
        <header class="h-20 flex items-center justify-between px-10 border-b bg-white/80 backdrop-blur">

            <h2 class="font-bold text-lg">Prem AI Clone</h2>

            <button onclick="exportChatPDF()"
                class="flex items-center gap-2 px-5 py-2.5
                bg-gradient-to-r from-purple-600 to-indigo-600
                text-white rounded-xl shadow-lg shadow-purple-500/20
                hover:scale-105 transition">

                ðŸ“„ Export PDF
            </button>

        </header>

        <!-- CHAT MESSAGES -->
        <div id="chat-box"
             class="flex-1 overflow-y-auto p-10 space-y-6 max-w-5xl mx-auto w-full">
        </div>

        <!-- INPUT AREA -->
        <div class="p-8 border-t bg-white">

            <div class="max-w-4xl mx-auto">

                <div class="bg-white rounded-3xl p-3 flex items-center gap-3 shadow-xl border">

                    <input id="user-input"
                        type="text"
                        placeholder="Message Prem AI..."
                        class="flex-1 bg-transparent border-none focus:ring-0 px-3 py-2"
                        onkeydown="handleEnter(event)">

                    <button onclick="startMic()"
                        class="w-12 h-12 flex items-center justify-center
                        text-gray-400 hover:text-blue-600 hover:bg-blue-50
                        rounded-xl transition">

                        ðŸŽ¤
                    </button>

                    <button onclick="sendMessage()"
                        class="w-12 h-12 bg-blue-600 text-white rounded-xl
                        hover:bg-blue-700 transition shadow-lg shadow-blue-500/30">

                        âž¤
                    </button>

                </div>

            </div>

        </div>

    </main>

</div>

<!-- MIC OVERLAY -->
<div id="micOverlay"
    class="hidden fixed inset-0 bg-white/70 backdrop-blur flex items-center justify-center z-50">

    <div class="bg-white p-12 rounded-3xl shadow-xl text-center">
        <div class="mic-visual">

            <div class="mic-core"></div>

                <div class="mic-wave wave1"></div>
                <div class="mic-wave wave2"></div>
                <div class="mic-wave wave3"></div>

        </div>
        <p class="mt-4 font-semibold text-lg">Listening...</p>
        <p class="text-gray-400 text-sm">Speak now</p>
    </div>

</div>

<!-- PDF LOADER -->
<div id="pdfLoader"
    class="hidden fixed inset-0 bg-black/40 flex items-center justify-center z-50">

    <div class="bg-white p-6 rounded-xl shadow-xl flex items-center gap-3">
        <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"></div>
        Generating PDF...
    </div>

</div>

<script src="{{ url_for('static', filename='js/chat.js') }}"></script>

{% endblock %}
